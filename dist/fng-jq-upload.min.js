!function(){"use strict";var a=angular.module("uploadModule",["blueimp.fileupload"]);a.directive("fngJqUploadForm",["$rootScope","fileUpload",function(){return{link:function(a,b,c){a.formScope=a.$parent,a.passedParams=a.formScope[c.schema],angular.extend(a.options,a.passedParams.add),a.url="/file/upload/"+a.formScope.modelName,a.options.url=a.url,a.options.maxFileSize=a.sizeLimit},restrict:"E",templateUrl:"templates/fileform.html",scope:{allowed:"@",url:"@",autoUpload:"@",sizeLimit:"@",name:"@"},controller:function(a,b,c,d){b.options={url:b.url,dropZone:c,maxFileSize:b.sizeLimit,autoUpload:b.autoUpload},b.loadingFiles=!1,b.queue||(b.queue=[]);var e=function(a){angular.forEach(a,function(a,c){a.url&&"/"!==a.url.charAt(0)&&(a.url="/"+a.url),a.deleteUrl&&"/"!==a.deleteUrl.charAt(0)&&(a.deleteUrl="/"+a.deleteUrl),a.thumbnailUrl&&"/"!==a.thumbnailUrl.charAt(0)&&(a.thumbnailUrl="/"+a.thumbnailUrl),b.queue[c]=a})};d.fieldData={},d.addFieldData=function(a,b){fieldData[a].push(b)},d.removeFieldData=function(a,b){angular.forEach(fieldData[a],function(c,d){c&&c._id&&c._id===b&&fieldData[a].splice(d,1)})},d.registerField=function(a){fieldData[a]||(fieldData[a]=[])},b.$watchCollection("filequeue",function(a){e(a)}),b.$watchCollection("queue",function(){})}}}]).controller("FileDestroyController",["$rootScope","$scope","$http","fileUpload",function(a,b,c,d){var e,f=b.file;b.uploadScope=b.$parent.$parent.$parent,b.formScope=b.uploadScope.$parent,b.name=b.uploadScope.passedParams.name,d.fieldData||(d.fieldData={}),d.fieldData[b.name]||(d.fieldData[b.name]=[]),b.filequeue=d.fieldData,f.url?(f.$state=function(){return e},f.$destroy=function(){return e="pending",c({url:f.deleteUrl,method:f.deleteType}).then(function(){e="resolved",d.removeFieldData(b.fieldname,f.result._id),b.clear(f)},function(){e="rejected",d.removeFieldData(b.fieldname,f.result._id),b.clear(f)})}):f.$cancel||f._index||(f.$cancel=function(){b.clear(f)})}])}(),angular.module("uploadModule").run(["$templateCache",function(a){"use strict";a.put("templates/fileform.html",'<div class=form-group id=cg_f_{{passedParams.name}}><label for=f_{{passedParams.name}} class=col-sm-2>{{passedParams.name | titleCase}}</label><div class=col-sm-10><div class=col-xs-12><div class=fileupload method=POST enctype=multipart/form-data data-ng-app=demo data-file-upload=options data-ng-class="{\'fileupload-processing\': processing() || loadingFiles}"><div class="row fileupload-buttonbar"><div class=col-lg-7><span class="btn btn-success fileinput-button" ng-class="{disabled: disabled}"><i class="glyphicon glyphicon-plus"></i> <span>Add files...</span> <input type=file name=files multiple ng-disabled=disabled></span> <button type=button class="btn btn-primary start" data-ng-click=submit()><i class="glyphicon glyphicon-upload"></i> <span>Start upload</span></button> <button type=button class="btn btn-warning cancel" data-ng-click=cancel()><i class="glyphicon glyphicon-ban-circle"></i> <span>Cancel upload</span></button>  <span class=fileupload-process></span></div><div class="col-lg-5 fade" data-ng-class="{in: active()}"><div class="progress progress-striped active" data-file-upload-progress=progress()><div class="progress-bar progress-bar-success" data-ng-style="{width: num + \'%\'}"></div></div><div class=progress-extended>&nbsp;</div></div></div><table class="table table-striped files ng-cloak"><tr data-ng-repeat="file in queue"><td data-ng-switch data-on=!!file.thumbnailUrl><div class=preview data-ng-switch-when=true><a data-ng-href={{file.url}} title={{file.name}} download={{file.name}} target=_blank data-gallery><img data-ng-src={{file.thumbnailUrl}} alt="" width=80 height=60></a></div><div class=preview data-ng-switch-default data-file-upload-preview=file></div></td><td><p class=name data-ng-switch data-on=!!file.url><span data-ng-switch-when=true data-ng-switch data-on=!!file.thumbnailUrl><a data-ng-switch-when=true data-ng-href={{file.url}} title={{file.name}} download={{file.name}} target=_blank data-gallery>{{file.name}}</a> <a data-ng-switch-default data-ng-href={{file.url}} title={{file.name}} download={{file.name}}>{{file.name}}</a></span> <span data-ng-switch-default>{{file.name}}</span></p><strong data-ng-show=file.error class="error text-danger">{{file.error}}</strong></td><td><p class=size>{{file.size | formatFileSize}}</p><div class="progress progress-striped active fade" data-ng-class="{pending: \'in\'}[file.$state()]" data-file-upload-progress=file.$progress()><div class="progress-bar progress-bar-success" data-ng-style="{width: num + \'%\'}"></div></div></td><td><button type=button class="btn btn-primary start" data-ng-click=file.$submit() data-ng-hide="!file.$submit || options.autoUpload" data-ng-disabled="file.$state() == \'pending\' || file.$state() == \'rejected\'"><i class="glyphicon glyphicon-upload"></i> <span>Start</span></button> <button type=button class="btn btn-warning cancel" data-ng-click=file.$cancel() data-ng-hide=!file.$cancel><i class="glyphicon glyphicon-ban-circle"></i> <span>Cancel</span></button> <button type=button class="btn btn-danger destroy" data-ng-click=file.$destroy() data-ng-hide=!file.$destroy data-ng-controller=FileDestroyController><i class="glyphicon glyphicon-trash"></i> <span>Delete</span></button></td></tr></table></div></div></div></div><div id=blueimp-gallery class="blueimp-gallery blueimp-gallery-controls" data-filter=:even><div class=slides></div><h3 class=title></h3><a class=prev>‹</a> <a class=next>›</a> <a class=close>×</a> <a class=play-pause></a><ol class=indicator></ol></div>')}]);